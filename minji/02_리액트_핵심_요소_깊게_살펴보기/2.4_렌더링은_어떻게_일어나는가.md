# 2.4 렌더링은 어떻게 일어나는가?

리액트에서 렌더링은 브라우저가 렌더링에 필요한 DOM트리를 만드는 과정을 의미함

### 2.4.1 리액트의 렌더링이란?

리액트에서 렌더링이란, 리액트 애플리케이션 트리 안에 있는 모든 컴포넌트들이 현재 자신들이 가지고 있는 props와 state의 값을 기반으로 어떻게 UI를 구성하고 이를 바탕으로 어떤 DOM 결과를 브라우저에 제공할 것인지 계산하는 일련의 과정을 말함

### 2.4.2 리액트의 렌더링이 일어나는 이유

- 리액트에서 렌더링이 발생하는 시나리오

  1. 최초 렌더링

     사용자가 애플리케이션에 접속했을 때 최초로 하는 렌더링

  2. 리렌더링

     최초 렌더링 이후의 모든 렌더링

     - 클래스형 컴포넌트의 setState가 실행되는 경우
     - 클래스형 컴포넌트의 forceUpdate가 실행되는 경우 -> forceUpdate가 실행되면 shouldComponentUpdate는 건너뛰게 됨 (하위 컴포넌트까지 적용)
     - 함수형 컴포넌트의 useState()의 setter가 실행되는 경우
     - 함수형 컴포넌트의 useReducer()의 dispatch가 실행되는 경우
     - 컴포넌트의 key props가 변경되는 경우
       > react에서 key 가 필요한 이유
       >
       > 어떠한 컴포넌트가 변경이 있었는지 구별하는 작업에 필요(리렌더링할 컴포넌트를 최소화 하기 위함)
     - props가 변경되는 경우
     - 부모 컴포넌트가 렌더링될 경우

### 2.4.3 리액트의 렌더링 프로세스

렌더링 프로세스가 시작되면 리액트는 컴포넌트의 루트에서부터 차근차근 아래쪽으로 내려가면서 업데이트가 필요하다고 지정돼 있는 모든 컴포넌트를 찾음 -> 업데이트가 필요하다고 지정되어 있는 컴포넌트를 발견하면 클래스형 컴포넌트는 `render()` 실행, 함수형 컴포넌트는 `FunctionComponent()` 호출 후 결과물을 저장

JSX문법으로 구성된 렌더링 결과물 -> js로 컴파일(React.createElement()...) -> 이때 createElement는 브라우저의 UI구조를 설명할 수 있는 js객체를 반환

위 과정을 거쳐 모든 렌더링 결과물 수집한 후, 가상 DOM과 비교해 실제 DOM에 반영하기 위한 변경 사항들을 수집

이렇게 계산하는 과정 -> Reconciliation(재조정)

재조정 과정이 끝나면 모든 변경 사항을 DOM에 적용해 변경된 결과물을 보여줌

### 2.4.4 렌더와 커밋

리액트의 렌더링 단계 -[다이어그램](https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/)

1. 렌더 단계

   렌더링 프로세스에서 컴포넌트를 실행해(render()또는 return) 이 결과와 이전 가상 DOM을 비교하는 과정을 거쳐 변경이 필요한 컴포넌트를 체크하는 단계 (type, props, key를 체크)

2. 커밋 단계

   렌더 단계의 변경 사항을 실제 DOM에 적용해 사용자에게 보여주는 과정 (이 단계 후에 브라우저의 렌더링이 발생)

   리액트의 렌더링 이후 변경사항이 없다면 커밋 단계는 생략됨

### 2.4.5 일반적인 렌더링 시나리오 살펴보기

컴포넌트를 렌더링하는 작업은 별도로 렌더링을 피하기 위한 조치가 돼 있지 않으면 모든 하위 컴포넌트에 영향을 미침
