# 4.2 ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ ìœ„í•œ ë¦¬ì•¡íŠ¸ API ì‚´í´ë³´ê¸°

### 4.2.1 `renderToString`

ì¸ìˆ˜ë¡œ ë„˜ê²¨ë°›ì€ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•´ HTML ë¬¸ìì—´ë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜, ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ êµ¬í˜„í•˜ëŠ” ë° ê°€ì¥ ê¸°ì´ˆì ì¸ API, ìµœì´ˆì˜ í˜ì´ì§€ë¥¼ HTMLë¡œ ë¨¼ì € ë Œë”ë§í•˜ëŠ” ì—­í• ì„ í•¨

```tsx
import ReactDOMServer from "react-dom/server";

function ChildComponent({ fruits }: { fruits: Array<string> }) {
  useEffect(() => {
    console.log(fruits);
  }, [fruits]);

  return (
    <ul>
      {fruits.map((fruit) => (
        <li key={fruit} onClick={handleClick}>
          {fruit}
        </li>
      ))}
    </ul>
  );
}

function SampleComponent() {
  return (
    <>
      <div>hello</div>
      <ChildComponent fruits={["apple", "banana", "peach"]} />
    </>
  );
}

const result = ReactDOMServer.renderToString(
  React.createElement("div", { id: "root" }, <SampleComponent />)
);
/*
resultëŠ” 

<div id="root" data-reactroot="">
  <div>hello</div>
  <ul>
    <li>apple</li>
    <li>banana</li>
    <li>peach</li>
  </ul>
</div>

ë¬¸ìì—´ì„ ë°˜í™˜
*/
```

- ChildComponentì˜ useEffectì™€ ê°™ì€ í›…ê³¼ handleClickê³¼ ê°™ì€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” ê²°ê³¼ë¬¼ì— í¬í•¨ë˜ì§€ ì•ŠìŒ

- `renderToString`ì€ ì¸ìˆ˜ë¡œ ì£¼ì–´ì§„ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë¸Œë¼ìš°ì €ê°€ ë Œë”ë§í•  ìˆ˜ ìˆëŠ” HTMLì„ ì œê³µí•˜ëŠ” ë° ëª©ì ì´ ìˆìŒ -> js ì½”ë“œëŠ” ì—¬ê¸°ì„œ ìƒì„±ëœ HTMLê³¼ ë³„ë„ë¡œ ë¸Œë¼ìš°ì €ì— ì œê³µë˜ì–´ì•¼ í•¨

- ì‚¬ìš©ìëŠ” HTMLì„ ë¹ ë¥´ê²Œ ë³¼ ìˆ˜ ìˆì§€ë§Œ ì›¹í˜ì´ì§€ê°€ ì‚¬ìš©ìì™€ ì¸í„°ë ‰ì…˜ í•  ì¤€ë¹„ê°€ ë˜ë ¤ë©´ javascript ì½”ë“œë¥¼ ë‹¤ìš´ë¡œë“œ, íŒŒì‹±, ì‹¤í–‰í•˜ëŠ” ê³¼ì •ì„ ê±°ì³ì•¼í•¨

- div#rootëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì˜ ë£¨íŠ¸ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì‹ë³„í•˜ëŠ” ì—­í• ì„ í•˜ë©°, ì´í›„ì— ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ [hydrate](#425-hydrate) í•¨ìˆ˜ì—ì„œ ë£¨íŠ¸ë¥¼ ì‹ë³„í•˜ëŠ” ê¸°ì¤€ì ì´ ë¨

### 4.2.2 `renderToStaticMarkup`

`renderToString` ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ë¦¬ì•¡íŠ¸ì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ì¶”ê°€ì ì¸ DOMì†ì„±ì€ ë§Œë“¤ì§€ ì•ŠìŒ -> ê²°ê³¼ë¬¼ì´ HTMLì˜ í¬ê¸°ë¥¼ ì¡°ê¸ˆì´ë¼ë„ ì¤„ì¼ ìˆ˜ ìˆìŒ

```javascript
const result = ReactDOMServer.renderToStaticMarkup(
  React.createElement("div", { id: "root" }, <SampleComponent />)
);
/*
<div id="root">
  <div>hello</div>
  <ul>
    <li>apple</li>
    <li>banana</li>
    <li>peach</li>
  </ul>
</div>
*/
```

- ë¦¬ì•¡íŠ¸ì™€ ê´€ë ¨ëœ ì½”ë“œì¸ data-reactrootê°€ ì‚¬ë¼ì§„ ìˆœìˆ˜í•œ HTML ë¬¸ìì—´ì´ ë°˜í™˜ë¨
- ì´ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ê²°ê³¼ë¡œ ë Œë”ë§ ì‹œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¦¬ì•¡íŠ¸ê°€ ì œê³µí•˜ëŠ” useEffectì™€ ê°™ì€ APIë¥¼ ì‹¤í–‰í•  ìˆ˜ ì—†ìŒ
- `renderToStaticMarkup`ì˜ ê²°ê³¼ë¬¼ì„ ê¸°ë°˜ìœ¼ë¡œ ë¦¬ì•¡íŠ¸ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•˜ëŠ” [hydrate](#425-hydrate)ë¥¼ ìˆ˜í–‰ ì‹œ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ì˜ ë‚´ìš©ì´ ë§ì§€ ì•Šë‹¤ëŠ” ì—ëŸ¬ ë°œìƒ
- ì•„ë¬´ëŸ° ë¸Œë¼ìš°ì € ì•¡ì…˜ì´ ì—†ëŠ” ì •ì ì¸ ë‚´ìš©ë§Œ í•„ìš”í•œ ê²½ìš°ì— ìœ ìš© (ë¸”ë¡œê·¸ ê¸€, ìƒí’ˆì˜ ì•½ê´€ ì •ë³´)

### 4.2.3 `renderToNodeStream`

`renderToString`ê³¼ ê²°ê³¼ë¬¼ì´ ì™„ì „íˆ ë™ì¼í•˜ì§€ë§Œ, `renderToNodeStream`ì€ node.js í™˜ê²½ì— ì˜ì¡´í•˜ê³  ìˆì–´ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì™„ì „íˆ ë¶ˆê°€ëŠ¥í•¨

`renderToNodeStream`ì˜ ê²°ê³¼ë¬¼ì€ Node.jsì˜ ReadableStream(Node.jsì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” utf-8ë¡œ ì¸ì½”ë”© ëœ ë°”ì´íŠ¸ ìŠ¤íŠ¸ë§)ì´ê¸° ë•Œë¬¸ì— ë¸Œë¼ìš°ì €ê°€ ì›í•˜ëŠ” ê²°ê³¼ë¬¼ì„ ì–»ê¸° ìœ„í•´ì„œëŠ” ì¶”ê°€ì ì¸ ì²˜ë¦¬ í•„ìš”
(ReadableStream ìì²´ëŠ” ë¸Œë¼ìš°ì €ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ ì´ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì´ ë¸Œë¼ìš°ì €ì—ì„œ ë¶ˆê°€ëŠ¥í•˜ê²Œ êµ¬í˜„ë˜ì–´ ìˆìŒ)

> Stream?
>
> í° ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ ë°ì´í„°ë¥¼ ì²­í¬(chunk, ì‘ì€ ë‹¨ìœ„)ë¡œ ë¶„í• í•´ ì¡°ê¸ˆì”© ê°€ì ¸ì˜¤ëŠ” ë°©ì‹

`renderToString`ì´ ìƒì„±í•˜ëŠ” ê²°ê³¼ë¬¼ì˜ í¬ê¸°ê°€ ë§¤ìš° í° ê²½ìš°, ì´ë¥¼ í•œ ë²ˆì— ë Œë”ë§í•˜ë ¤ê³  í•˜ë©´ ì‹œê°„ì´ ë§ì´ ì†Œìš”ë  ê²ƒì„ -> `renderToNodeStream`ì„ ì‚¬ìš©í•´ ì²­í¬ ë‹¨ìœ„ë¡œ ë¶„í• í•˜ì—¬ ë¸Œë¼ìš°ì €ì— HTMLì„ ì‘ì€ ë‹¨ìœ„ë¡œ ìª¼ê°œì„œ ì œê³µí•  ìˆ˜ ìˆìŒ -> Node.js ì„œë²„ì˜ ë¶€ë‹´ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤!(í° ë°ì´í„°ë¥¼ í•œêº¼ë²ˆì— ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ë‘ê³  ì‘ë‹µì„ ìˆ˜í–‰í•˜ì§€ ì•Šì•„ë„ ë˜ê¸° ë•Œë¬¸)

### 4.2.3 `renderToStaticNodeStream`

`renderToNodeStream`ê³¼ ë™ì¼í•˜ì§€ë§Œ ë¦¬ì•¡íŠ¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ì— í•„ìš”í•œ ë¦¬ì•¡íŠ¸ ì†ì„±ì´ ì œê³µë˜ì§€ ì•ŠìŒ

### 4.2.5 `hydrate`

ì •ì ìœ¼ë¡œ ìƒì„±ëœ HTML ì½˜í…ì¸ ì— ìë°”ìŠ¤í¬ë¦½íŠ¸ í•¸ë“¤ëŸ¬ë‚˜ ì´ë²¤íŠ¸ë¥¼ ë¶™ì´ëŠ” ì—­í• ì„ í•¨

##### ğŸ”· render

- ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ë©”ì„œë“œë¡œ, ì¸ìˆ˜ë¡œ ë°›ì€ ë‘ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ HTMLì˜ ìš”ì†Œì— í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ê³  ì—¬ê¸°ì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ë¶™ì´ëŠ” ì‘ì—…ê¹Œì§€ ìˆ˜í–‰

##### ğŸ”· hydrate

```tsx
const element = document.getElementById(containerId);
ReactDOM.hydrate(<App />, element);
```

- hydrateëŠ” ì´ë¯¸ ë Œë”ë§ëœ HTMLì´ ìˆë‹¤ëŠ” ê°€ì •í•˜ì— ì‘ì—…ì´ ìˆ˜í–‰ë˜ì–´, ë Œë”ë§ëœ HTMLì„ ê¸°ì¤€ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ ë¶™ì´ëŠ” ì‘ì—…ë§Œ ì‹¤í–‰ë¨

- hydrateì˜ 2ë²ˆì§¸ ì¸ìˆ˜ë¡œ ë¦¬ì•¡íŠ¸ ê´€ë ¨ ì •ë³´ê°€ ì—†ëŠ” ìˆœìˆ˜í•œ HTMLì •ë³´ë¥¼ ë„˜ê²¨ì£¼ë©´ ë Œë”ë§ëœ ì •ë³´ê°€ ì—†ì–´ ê²½ê³  ë¬¸êµ¬ê°€ ì¶œë ¥ë¨
  -> hydrate ì‘ì—…ì´ ì´ë²¤íŠ¸ë‚˜ í•¸ë“¤ëŸ¬ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒ ì™¸ì—ë„ ë Œë”ë§ì„ í•œ ë²ˆ ìˆ˜í–‰í•˜ë©´ì„œ hydrateê°€ ìˆ˜í–‰í•œ ë Œë”ë§ ê²°ê³¼ë¬¼ HTMLê³¼ ì¸ìˆ˜ë¡œ ë„˜ê²¨ë°›ì€ HTMLì„ ë¹„êµí•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•¨. ì´ ë•Œ ë¶ˆì¼ì¹˜ ë°œìƒ ì‹œ ê²½ê³ 
- ì´ë•Œ ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•˜ë©´ hydrateê°€ ë Œë”ë§í•œ ê¸°ì¤€ìœ¼ë¡œ ì›¹í˜ì´ì§€ë¥¼ ê·¸ë¦¼ -> ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ 2ë²ˆ ë Œë”ë§ì„ í•˜ê²Œ ë˜ëŠ” ê²ƒì´ë¯€ë¡œ ê³ ì³ì•¼ í•˜ëŠ” ë¬¸ì œì„

- suppressHydrationWarning

  ```jsx
  <div suppressHydrationWarning>{new Date().getTime()}</div>
  ```

  ë¶ˆê°€í”¼í•˜ê²Œ ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê²½ìš°ì—ëŠ” suppressHydrationWarningë¥¼ ì¶”ê°€í•´ ê²½ê³ ë¥¼ ëŒ ìˆ˜ ìˆìŒ

### 4.2.6 ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ì˜ˆì œ í”„ë¡œì íŠ¸

### 4.2.7 ì •ë¦¬

ì–´ëŠ ì •ë„ ì„±ëŠ¥ì´ ë³´ì¥ëœ ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ êµ¬í˜„í•˜ë ¤ë©´ ë§¤ìš° ë³µì¡í•œ ì½”ë“œê°€ í•„ìš”í•¨
-> Next.js ë“±ì˜ í”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í•˜ì
