# **Chapter-04**

## **4.1 서버 사이드 렌더링이란?**

서문에서 전하는 이야기
- 서버 사이드 렌더링이 각광 받게 된 이론적인 측면
- SPA 보다 왜 신경 쓸 점이 훨씬 많은지?
- 왜 SSR이 필요한지
- 현재 웹의 상황

## Table of contents
- [1.1. SPA의 세상](#11-spa의-세상)
- [1.2. 서버 사이드 렌더링이란?](#12-서버-사이드-렌더링이란)
- [1.3. SPA와 SSR을 모두 알아야 하는 이유](#13-spa와-ssr을-모두-알아야-하는-이유)

---


## 1.1. SPA의 세상

### SPA란?
Single Page Application는 렌더링과 라우팅에 필요한 대부분의 기능을 서버가 아닌 브라우저의 자바스크립트에 의존하는 방식을 의미

- 최초 첫 페이지에서 데이터를 모두 불러옴
- 페이지 전환을 위한 작업이 자바스크립트와 브라우저의 history.pushState, history.replaceState로 이루어짐
- 페이지를 불러온 이후 서버에서 HTML을 내려받지 않고, 하나의 페이지에서 모든 작업을 처리
  - 다음 페이지 렌더링에 필요한 정보만 HTTP 요청으로 가져옴
  - 가져온 결과를 바탕으로 DOM을 추가, 수정, 삭제하는 방법으로 페이지 전환

#### 장점
  - 한번 로딩된 이후 서버를 거쳐 필요한 리소스를 받아올 일이 적음 
    - 사용자에게 훌룡한 UI/UX를 제공할 수 있음    

#### 단점
  - 최초 로딩해야 할 자바스크립트 리소스가 큼


### 전통적인 방식과 SPA의 작동 비교

- 전통적인 방식
  - 페이지 전환이 발생할 때마다 페이지 요청
    - 새롭게 페이지 요청, HTML을 다운로드 및 파싱
  - 페이지 전환 부자연스러움

- SPA 방식
  - 최초 한번 모든 리소스 다운로드
  - 페이지 전환시 추가적인 리소스를 다운로드하는 시간이 없어짐
  - 페이지 전환에 필요한 부분만 다시 그리므로 매끄러움


### 싱글 페이지 렌더링 방식의 유행과 JAM 스택의 등장

#### 싱글 페이지 렌더링 방식의 등장 배경
- 자바스크립트는 사용자에게 추가적인 경험을 주기 위한 보조 수단
- 자바스크립트가 다양한 작업을 수행하며 모듈화 방안이 점차 논의
  - 이때 등장한 것이 CommonJS와 AMD, 그리고 모듈화 결실
  - 사용자 기기 성능 향상, 인터넷 속도의 발전으로 자바스크립트에서 할 수 있는 일이 다양해짐
- 자바스크립트의 역할과 규모가 커지는 계기
  - 2010년경 등장한 Backbone.js, AngularJS, Knockout.js 등의 MVx 프레임워크
- 프레임워크의 인기가 자바스크립트의 역할을 가중시킴
  - React, Vue, Angular 의 시대가 오게됨


### 새로운 패러다임의 웹서비스를 향한 요구

- 많은 양의 리소스가 JS로 넘어옴, JS 코드의 규모가 커지면서 우려의 목소리 나옴
- 폭발적인 기술의 발전으로 해결을 기대
  - 인터넷 속도의 증가
  - 하드웨어 성능의 눈부신 발전
- 웹 페이지를 불러오는데 발생하는 부담의 일정 부분을 사용자에게 전가할 수 있을 것이라는 기대
  - 사용자의 기기나 인터넷 환경은 더 발전할 것이므로

---

## 1.2. 서버 사이드 렌더링이란?

- SSR은 최초에 사용자에게 보여줄 페이지를 서버에서 런데링해 빠르게 제공하는 방식
- 웹 페이지가 느려지는 문제의식을 SPA 의 태생적 한계에서 찾고, 기존 웹 개발 방식의 장점을 가져오기 위해 떠오르는 방법이 됨
- SPA와 SSR은 책임을 어디에 두는지에 따라 차이가 발생
  - SPA는 사용자에게 제공되는 자바스크립트 번들에서 렌더링 담당
  - SSR은 렌더링에 필요한 모든 작업을 서버에서 담당

### 서버 사이드 렌더링의 장점
1. 최초 페이지 진입이 비교적 빠르다
2. 검색 엔진과 SNS 공유 등 메타데이터 제공이 쉽다
3. 누적 레이아웃 이동이 적다
4. 사용자의 디바이스 성능에 비교적 자유롭다
5. 보안에 좀 더 안전하다

### 서버 사이드 렌더링의 단점
1. 소스코드를 작성할 때 항상 서버를 고려해야 한다
2. 적절한 서버가 구축돼 있어야 한다
3. 서비스 지연에 따른 문제

## 1.3. SPA와 SSR을 모두 알아야 하는 이유
SSR이 모든 문제의 해결책이 될 수 없으므로..!

### 서버 사이드 렌더링 역시 만능이 아니다
- 무거운 작업을 서버로 미룬다고 해서 성능 문제가 해결되는 것은 아님
- 잘못된 웹 페이지 설계는 성능도 해치고, 서버와 클라이언트로 관리 포인트만 늘어남
- **중요한 것은 설계**
  - 웹 페이지에서 사용자에게 제공하고 싶은 내용은 무엇인지
  - 어떤 우선순위에 따라 내용을 보여줄지 설계하는 것이 중요


### SPA와 SSR App

#### 가장 뛰어난 SPA는 멀티 페이지 App 보다 낫다
예시는 Gmail

- 최초 진입시 보여주어야 할 정보만 최적화해 렌더링하고, 
- 중요성이 떨어지는 리소스는 레이지 로딩, 
- 코드 스플리팅을 통해 불필요한 자바스크립트 리소스의 다운로드 및 실행을 방지
- 라우팅이 발생하면 변경이 필요한 영역만 교체하여 사용자의 피로감 최소화
- SPA가 가진 브라우저 API와 자바스크립트를 활용한 매끄러운 라우팅보다 뛰어난 성능은 보여주기 힘듦

#### 평균적인 SPA는 평균적인 멀티 페이지 App 보다 느리다
평균적인 멀티 페이지 App은 매번 서버에 렌더링 요청을 하고, 서버의 안정적인 리소스를 기반으로 비슷한 성능의 렌더링을 수행할 것이다

- 렌더링과 라우팅 최적화가 되어 있지 않다면 사용자 기기에 따라 성능이 들쑥날쑥함
- 적절한 성능 최적화가 되어 있지 않으면 멀티 페이지 App보다 성능이 아쉽다
- 다운로드나 렌더링 우선순위 전략을 수립하는 것은 어렵다


### 현대의 서버 사이드 렌더링
초기 빠른 페이지 진입, 빠른 라우팅 같은 두 마리 토끼를 잡은 현대의 SSR
- 먼저 최초 웹사이트 진입시에는 SSR 방식으로 서버에서 완성된 HTML을 제공받음
- 라우팅에서는 서버에서 내려받은 자바스크립트를 바탕으로 SPA처럼 작동

---


## 4.2 서버 사이드 렌더링을 위한 리액트 API 살펴보기
