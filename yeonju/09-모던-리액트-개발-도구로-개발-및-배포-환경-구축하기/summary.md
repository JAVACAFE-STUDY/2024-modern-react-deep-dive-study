# 9장 모던 리액트 개발 도구로 개발 및 배포 환경 구축하기

### 9.1.3 next.config.js 작성하기

- `eslint.ignoreDuringBuilds`: 빌드 시에 ESUnt를 무시한다. 일반적으로 Next.js 빌드 시에 ESUnt도 같이 수행하는데, 여기서는 true로 설정해 빌드 시에 ESLint# 수행하지 않게 했다. 이후에 ES니nt는 CI 과정에서 별도로 작동하게 만들어 빌드를 더욱 빠르게 만들 것이다.

### 9.1.4 ESLint와 Prettier 설정하기

- ©titicaca/eslint-config-triple
  - eslint-config-next는 단순히 코드에 있을 잠재적인 문제를 확인할 뿐，띄어쓰기나 줄바꿈과 같이 코드의 스타일링을 정의해 주지는 않는다. 코드 스타일링 등 eslint-config-next가 해주지 않는 일반적인 ESLint 작업을 수행하기 위해 가장 설치 및 설정이 쉬운 ©titicaca/eslint-config-triple을 설치해 사용한다.

### 9.1.7 정리

- 보일러플레이트 활용방법
  1. 먼저 보일러플레이트 프로젝트를 만든 다음，깃허브에서 template repository，옵션을 체크해두 는 것이다.
     - 이렇게 저장소를 템플릿 저장소로 만들어두면 다른 저장소를 생성할 때 이 내용을 모두 복사해서 생성할 수 있다.
  2. 나만의 create-\*\*\*-app 만들기
     - create-next-app 내부의 ?드: create-next-app의 소스코드8를 살펴보면 알겠지만 일단 하나의 템플릿을 미리 만들어 둔 다음. 여기에서 C니로 사용자의 입력을 받아 커스터마이징한 것을 알 수 있다.
     - Creating a CLI tool with Node.js9: npm을 기반으로 CLI 패키지를 만드는 방법을 상세하게 설명하고 있다.

## 9.2 깃허브 100% 활용하기

### 9.2.1 깃허브 액션으로 CI 환경 구축하기

- CI?
  - 여러 기여자가 기여한 코드를 지속적으로 빌드하고 테스트해 코드의 정합성을 확인하는 과정
  - CI의 핵심은 저장소에서 코드의 변화가 있을 때마다 전체 소프트웨어의 정합성을 확인하기 위한 작업을 자동 으로 실행해야 한다는 것
  - ex. 테스트，빌드, 정적 분석，보안 취약 점 분석 등
- 젠킨스(Jenkins)?
  - 과거 CI 환경을 구축하기 위해 가장 자주 쓰인 솔루션
  - 장점: 편리하고 많은 플러그인을 통해 다양한 기능을 통합할 수 있음
  - 단점: 설치 및 유지보수가 번거로움
- 깃허브 액션?
  - 깃허브에서 출시한 SaaS로，깃허브 저장소와 함께 사용할 수 있는 강력한 도구
  - 깃허브 저장소를 기반으로 깃 허브에서 발생하는 다양한 이벤트를 트리거 삼아 다양한 작업을 할 수 있게 도와주는 것
  - Cl/CD(Continuous Integration/Continuous Delivery) 솔루션을 대체할 수 있음
- 깃허브 액션 jobs 값
  - 한 개 이상 설정할 수 있으며, 여러 개를 지정하면 병렬로 실행됨
- `jobs.build.runs-on`
  - 깃허브에서 제공하는 서버를 쓰고 싶다면 ubuntu-latest를 선언하면 된다
  - 만약 커스텀 러너를 쓴다면 해당 러너명을 지정하면 된다
    - 커스텀 러너를 쓰고 싶다면 저장소의 Settings — Actions — Runners에서 추가할 수 있다.
  - 그 외에도 사용 가능한 환경은 깃허브 문서14를 참고한다.
- `actions/checkout@v3`
  - actions/checkout@v3은 깃허브에서 제공하는 기본 액션15으로로 별도 파라미터를 제공하지 않으면 해당 브랜치의 마지막 커밋을 기준으로 체크아웃
  - 최신 코드를 기준으로 작동해야 하는 CI 액션에서는 필수적으로 사용된다.
- 브랜치 보호 규칙
  - 예를 들어，기본 브랜치인 main 브랜치에 대해 'Require status checks to pass before merging(머지하기 전에 상태 체크를 필수로 한다)’과 "Require branches to be up to date before merging(머지하기 전에 브랜치가 최신 내용 인지 확인한다)’을 체크해 해당 브랜치가 최신 상태인지 확인하고 머지할 수 있는 기능을 켠다. 그리고 마지 막으로 꼭 실행돼야 하는 액션의 파일명을 선택하고 저장하면，해당 액션이 성공하기 전까지는 main 브랜치 에 대한 머지를 막을 수 있다. 즉，기본 브랜치에는 항상 테스트，빌드와 같은 CI가 성공한 코드만 푸시될 수 있어 코드의 정합성을 확보할 수 있다.

### 9.2.2 직접 작성하지 않고 유용한 액션과 깃허브 앱 가져다 쓰기

- 깃허브에서 제공하는 기본 액션
  - `actions/checkout`: 깃허브 저장소를 체크아웃하는 액션이다. 저장소를 기반으로 작업을 해야 한다면 반드시 필요하 다. 일반적으로는 아무런 옵션 없이 사용해 해당 액션을 트리거한 최신 커밋을 불러오지만 ref를 지정해 특정 브랜치 나 커밋을 체크아웃할 수도 있다.
  - `actions/setup-node`: Node.js> 설치하는 액션이다. Node.jsB 사용하는 프로책트라면 반드시 필요하다. 설치할 Nodejs 버전을 지정할 수도 있다.
  - `actions/github-script18`: GitHub API가 제공하는 기능을 사용할 수 있도록 도와주는 액션이다. GitHub API> 이 용하면 깃허브에서 할 수 있는 대부분의 작업을 수행할 수 있으므로 한 번쯤 API 문서19를 보는 것을 추천한다.
  - `actions/stale20`: 오래된 이슈나 PR을 자동으로 닫거나 더 이상 커뮤니케이션하지 못하도록 닫는다. 저장소가 오래 되어 과거에 생성된 이슈나 풀 리퀘A 트가 너무 많을 경우 정리하는 데 도움이 된다.
  - `actions/dependency-review-action21`: 의존성 그래프에 대한 변경, 즉 package, json, package-lock.json, pnpm-lock.yaml 등의 내용이 변경됐을 때 실행와는 액션으로 의존성을 분석해 보안 또는 라이선스에 문제가 있다면 이를 알려준다.
  - `github/codeql-action22`: 깃허브의 코드 분석 솔루션인 code-아을 활용해 저장소 내 코드의 취약점을 분석해 준다. languages에 javascript만 설정해 두면 자바스크립트와 타입스크립트를 모두 검사하므로23 특정 스케줄에 맞춰서 실행하거나 CI로 활용할 수 있다.
- `calibreapp/image-actions`
  - PR로 올라온 이미지(jpg, jpeg, png 등)를 sharp 패키지를 이용해 거의 무손실로 압 축해서 다시 커밋해 준다.
  - 만약 액션을 설정하는 것조차 번거롭게 느껴진다면 imgbot26이라고 하는 앱을 사용할 수도 있다.
- `lirantal/is-website-vulnerable`
  - 특정 웹사이트를 방문해 해당 웹사이트에 라이브러리 취약점이 존재하는지 확인하는 깃허브 액션
- `Lighthouse Cl`
  - 웹 성능 지표인 라이트하우스를 CI를 기반으로 실행할 수 있도록 도와주는 도구
